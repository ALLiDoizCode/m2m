<!-- Powered by BMADâ„¢ Core -->

# Story 17.10: delegate_task Skill

## Status

Draft

## Story

**As a** connector operator running an AI agent,
**I want** a `delegate_task` AI skill for agent-to-agent task delegation,
**So that** the AI can autonomously delegate specialized tasks to capable peer agents, enabling distributed workload execution.

## Acceptance Criteria

1. Skill registered as `delegate_task`
2. Parameters: taskDescription, targetKind, timeout, preferredAgent
3. Discovers capable agents via Epic 18 capability discovery
4. Creates Kind 5900 task request
5. Sends via ILP with appropriate payment
6. Awaits and parses Kind 6900 result
7. Returns result to AI agent
8. Handles timeout and retries
9. Logs delegation decisions

## Tasks / Subtasks

- [ ] Task 1: Create delegate_task skill (AC: 1, 2, 4, 5, 6, 7)
  - [ ] Define Zod schema for parameters
  - [ ] Implement execute function
  - [ ] Create Kind 5900 event
  - [ ] Send via ILP

- [ ] Task 2: Integrate capability discovery (AC: 3)
  - [ ] Use Epic 18 discovery API
  - [ ] Select capable agent
  - [ ] Fallback if preferred unavailable

- [ ] Task 3: Implement timeout/retry (AC: 8)
  - [ ] Respect timeout parameter
  - [ ] Handle retry logic
  - [ ] Return errors gracefully

- [ ] Task 4: Add logging (AC: 9)
  - [ ] Log delegation decisions
  - [ ] Log selected agent
  - [ ] Log success/failure

- [ ] Task 5: Tests (AC: all)
  - [ ] Unit tests for skill logic
  - [ ] Integration test with real agent

## Dev Notes

**Skill Definition:**

```typescript
const delegateTaskSkill: AgentSkill<typeof schema> = {
  name: 'delegate_task',
  description: 'Delegate task to capable agent',
  parameters: z.object({
    taskDescription: z.string(),
    targetKind: z.number(),
    timeout: z.number().optional(),
    preferredAgent: z.string().optional(),
  }),
  execute: async (params, context) => {
    // Discover agents
    const agents = await context.discovery.discoverForKind(params.targetKind);

    // Create Kind 5900
    const taskEvent = createTaskRequest(params);

    // Send via ILP
    const result = await context.sendEvent(taskEvent, agent.ilpAddress);
    return parseTaskResult(result);
  },
};
```

**Dependencies:**

- Epic 18 capability discovery
- Kind 5900/6900 support (Stories 17.6-17.7)

[Source: docs/prd/epic-17-nip-90-dvm-compatibility.md#story-1710]

---

## Change Log

| Date       | Version | Description   | Author |
| ---------- | ------- | ------------- | ------ |
| 2026-01-28 | 1.0     | Story created | SM     |

---

## Dev Agent Record

[To be filled by Dev Agent]

---

## QA Results

[To be filled by QA Agent]
